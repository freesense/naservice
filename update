cd aria2
docker-compose pull
docker-compose down
docker-compose up -d

cd ../jellyfin
docker-compose pull
docker-compose down
docker-compose up -d

cd ../mydb
OLDVER=$(sed -rn 's/image:\s*mayflygo\/mayfly-go:(\S+)/\1/p' docker-compose.yaml)
LATEST=$(./update.py)
printf 'mayfly-go current version: %s, latest version: %s.\n' $OLDVER $LATEST
if [ $LATEST != error ] && [ $OLDVER != $LATEST ]; then
    sed -ri "s/(image:\s*mayflygo\/mayfly-go:)\S+/\1$LATEST/g" docker-compose.yaml
    docker-compose pull
    docker-compose down
    docker pull alpine
    docker-compose up -d
fi

cd ../portainer
docker-compose pull
docker-compose down
docker-compose up -d

cd ../qbittorrent
docker-compose pull
docker-compose down
docker-compose up -d

cd ../trilium
docker-compose pull
docker-compose down
docker-compose up -d

cd ../calibre
docker-compose pull
docker-compose down
docker-compose up -d

cd ../webdav
docker-compose pull
docker-compose down
docker-compose up -d

cd ../rainloop
docker-compose pull
docker-compose down
docker-compose up -d

docker image ls|grep '<none>'|grep -v grep|awk {'print $3}'|xargs docker rmi
docker image ls

